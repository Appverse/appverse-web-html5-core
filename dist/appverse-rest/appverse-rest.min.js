/*! appverse-web-html5-core - v0.7.1 - */
!function(){"use strict";function a(a,b,c,d,e){function f(){var b=a.get("RESTFactory"),c=a.get("$log"),e=a.get("SECURITY_GENERAL");if(d.exists("appverse.security")){var f=a.get("Oauth_RequestWrapper");if(e.securityEnabled)return b.wrapRequestsWith(f),void c.debug("REST communication is secure. Security is enabled. REST requests will be wrapped with authorization headers.")}b.enableDefaultContentType(),c.debug("REST communication is not secure. Security is not enabled.")}function g(){if(d.exists("appverse.cache")){var b=a.get("RESTFactory"),c=a.get("avCacheFactory"),e=c.getHttpCache();b.setCache(e)}}f(),g(),c.setBaseUrl(e.BaseUrl),c.setExtraFields(e.ExtraFields),c.setParentless(e.Parentless);for(var h,i=0;i<e.ElementTransformer.length;i++)b.debug("Adding transformer"),h=e.ElementTransformer[i],c.addElementTransformer(h.route,h.transformer);c.setOnElemRestangularized(e.OnElemRestangularized),"function"==typeof e.RequestInterceptor&&(b.debug("Setting RequestInterceptor"),c.setRequestInterceptor(e.RequestInterceptor)),"function"==typeof e.FullRequestInterceptor&&(b.debug("Setting FullRequestInterceptor"),c.setFullRequestInterceptor(e.FullRequestInterceptor)),c.setErrorInterceptor(e.ErrorInterceptor),c.setRestangularFields(e.RestangularFields),c.setMethodOverriders(e.MethodOverriders),c.setFullResponse(e.FullResponse),c.setRequestSuffix(e.RequestSuffix),c.setUseCannonicalId(e.UseCannonicalId),c.setEncodeIds(e.EncodeIds),b.info("appverse.rest run")}a.$inject=["$injector","$log","Restangular","ModuleSeeker","REST_CONFIG"];var b=["restangular","appverse.configuration","appverse.utils"];angular.module("appverse.rest",b).run(a)}(),function(){"use strict";angular.module("appverse.rest").directive("avRestGet",["$log","Restangular","$rootScope","$timeout","REST_CONFIG",function(a,b,c,d,e){return{restrict:"A",link:function(f,g,h){a.debug("avRestGet directive",h);var i,j="Getting",k="Error";h.restName?i=h.restName:(i=h.avRestGet.split("/").reverse()[0],h.restId&&"s"===i.charAt(i.length-1)&&(i=i.substr(0,i.length-1))),f[i+j]=!0,f.$watchCollection(function(){return[h.avRestGet,h.restId,h.restName]},function(f,g,l){function m(b){a.debug("onSuccess",b),d(function(){l[i+j]=!1,l.$headerContainer?l.$parent[i]=b:l[i]=b},e.Timeout)}function n(b){a.debug("onError",b),d(function(){l[i+j]=!1,l[i+k]=!0,c[i+"Errors"]||(c[i+"Errors"]=[]),c[i+"Errors"].push(b)},e.Timeout)}a.debug("avRestGet watch "+i+":",f),l[i+k]=!1,h.restId?b.all(h.avRestGet).one(h.restId).get().then(m,n):b.all(h.avRestGet).getList().then(m,n)})}}}]).directive("avRestRemove",["$log","$rootScope","$timeout","REST_CONFIG",function(a,b,c,d){return{restrict:"A",link:function(e,f,g){f.click(function(){function f(b){a.debug("onSuccess",b),c(function(){e[l+i]=!1;var a=k.getParentList(),b=a.indexOf(k);b>-1&&a.splice(b,1)},d.Timeout)}function h(f){a.debug("onError",f),c(function(){e[l+i]=!1,e[l+j]=!0,b[l+"Errors"]||(b[l+"Errors"]=[]),b[l+"Errors"].push(f)},d.Timeout)}var i="Removing",j="Error",k=e.$eval(g.avRestRemove),l=k.route.split("/").reverse()[0];a.debug("avRestRemove directive",k),(!g.restIf||e.$eval(g.restIf))&&(e[l+i]=!0,e[l+j]=!1,k.remove().then(f,h))})}}}]).directive("avRestSave",["$log","$rootScope","Restangular","$timeout","REST_CONFIG",function(a,b,c,d,e){return{restrict:"A",link:function(f,g,h){g.click(function(){function g(b){a.debug("onSuccess",b),d(function(){f[o+j]=!1,m[n]=l},e.Timeout)}function i(c){a.debug("onError",c),d(function(){f[o+j]=!1,f[o+k]=!0,m=l.getParentList(),n>-1&&(l.fromServer?m.splice(n,1,f.copy):m.splice(n,1)),b[o+"Errors"]||(b[o+"Errors"]=[]),b[o+"Errors"].push(c)},e.Timeout)}var j="Saving",k="Error",l=f.$eval(h.avRestSave),m=l.getParentList(),n=m.indexOf(l),o=m.route.split("/").reverse()[0];a.debug("avRestSave directive",l),(!h.restIf||f.$eval(h.restIf))&&(f[o+j]=!0,f[o+k]=!1,l.save?delete l.editing:c.restangularizeElement(null,l,o),l.save().then(g,i))})}}}]).directive("avRestAdd",["$log",function(a){return{restrict:"A",link:function(b,c,d){c.click(function(){var c=b.$eval(d.avRestAdd);a.debug("avRestAdd directive",c),c.unshift({editing:!0,getParentList:function(){return c}}),b.$applyAsync()})}}}]).directive("avRestClone",["$log",function(a){return{restrict:"A",link:function(b,c,d){c.click(function(){var c=b.$eval(d.avRestClone),e=c.getParentList();a.debug("avRestClone directive",c);var f=c.clone();f.fromServer=!1,f.editing=!0,e.unshift(f),b.$applyAsync()})}}}]).directive("avRestEdit",["$log",function(a){return{restrict:"A",link:function(b,c,d){c.click(function(){var c=b.$eval(d.avRestEdit);a.debug("avRestEdit directive",c),b.copy=c.clone(),c.editing=!0,b.$applyAsync()})}}}]).directive("avRestCancel",["$log",function(a){return{restrict:"A",link:function(b,c,d){c.click(function(){a.debug("avRestCancel directive",b);var c,e=b.$eval(d.avRestCancel);c=e.getParentList?e.getParentList():b[d.restName||d.avRestCancel+"s"];var f=c.indexOf(e);f>-1&&(b.copy?c.splice(f,1,b.copy):c.splice(f,1)),b.$applyAsync()})}}}])}(),function(){"use strict";function a(a,b,c,d,e){var f={};return f.wrapRequestsWith=function(a){d=a.wrapRequest(d)},f.enableDefaultContentType=function(){d.setDefaultHeaders({"Content-Type":e.DefaultContentType})},f.setCache=function(a){d.setResponseInterceptor(function(b,c){return a&&e.NoCacheHttpMethods[c]===!0&&a.removeAll(),b})},f.readBatch=function(a){var e=b.defer();return c.get(d.configuration.baseUrl+"/"+a+d.configuration.suffix).success(function(a){e.resolve(a)}),e.promise},f.readParallelMultipleBatch=function(a){var c=[];return angular.forEach(a,function(a){var d=b.defer();f.readBatch(a).then(function(a){d.resolve(a)},function(){d.reject()}),c.push(d.promise)}),b.all(c)},f}a.$inject=["$log","$q","$http","Restangular","REST_CONFIG"],angular.module("appverse.rest").factory("RESTFactory",a)}();
//# sourceMappingURL=appverse-rest.min.js.map