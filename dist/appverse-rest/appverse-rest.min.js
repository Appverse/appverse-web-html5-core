/*! appverse-web-html5-core - v0.7.6 - */
!function(){"use strict";angular.module("appverse.rest",["restangular","appverse.configuration","appverse.utils"]).run(["$injector","$log","Restangular","ModuleSeeker","REST_CONFIG",function(a,b,c,d,e){function f(){var b=a.get("RESTFactory"),c=a.get("$log"),e=a.get("SECURITY_GENERAL");if(d.exists("appverse.security")){var f=a.get("Oauth_RequestWrapper");if(e.securityEnabled)return b.wrapRequestsWith(f),void c.debug("REST communication is secure. Security is enabled. REST requests will be wrapped with authorization headers.")}c.debug("REST communication is not secure. Security is not enabled.")}function g(){if(d.exists("appverse.cache")){var b=a.get("RESTFactory"),c=a.get("avCacheFactory"),e=c.getHttpCache();b.setCache(e)}}if(b.info("appverse.rest run"),f(),g(),c.setBaseUrl(e.BaseUrl),c.setExtraFields(e.ExtraFields),c.setParentless(e.Parentless),c.setRestangularFields(e.RestangularFields),c.setMethodOverriders(e.MethodOverriders),c.setFullResponse(e.FullResponse),e.DefaultHeaders&&c.setDefaultHeaders(e.DefaultHeaders),c.setRequestSuffix(e.RequestSuffix),c.setUseCannonicalId(e.UseCannonicalId),c.setEncodeIds(e.EncodeIds),e.HATEOAS){var h="content",i="href",j="links";c.setResponseExtractor(function(a,b){var c=a;if("getList"===b&&h in a){for(var d=0;d<a[h].length;d++)a[h][d][i]=a[h][d][j][0][i],delete a[h][d][j];c=a[h],delete a[h];for(var e in a)c[e]=a[e]}return c})}}])}(),function(){"use strict";angular.module("appverse.rest").directive("avRestGet",["$log","Restangular","$rootScope","$timeout","REST_CONFIG",function(a,b,c,d,e){return{restrict:"A",link:function(f,g,h){a.debug("avRestGet directive",h);var i,j="Getting",k="Error";h.restName?i=h.restName:(i=h.avRestGet.split("/").reverse()[0],h.restId&&"s"===i.charAt(i.length-1)&&(i=i.substr(0,i.length-1))),f[i+j]=!0,f.$watchCollection(function(){return[h.avRestGet,h.restId,h.restName]},function(f,g,l){function m(b){a.debug("onSuccess",b),d(function(){l[i+j]=!1,l.$headerContainer?l.$parent[i]=b:l[i]=b},e.Timeout)}function n(b){a.debug("onError",b),d(function(){l[i+j]=!1,l[i+k]=!0,c[i+"Errors"]||(c[i+"Errors"]=[]),c[i+"Errors"].push(b)},e.Timeout)}a.debug("avRestGet watch "+i+":",f),l[i+k]=!1,h.restId?b.all(h.avRestGet).one(h.restId).get().then(m,n):b.all(h.avRestGet).getList().then(m,n)})}}}]).directive("avRestRemove",["$log","$rootScope","$timeout","REST_CONFIG",function(a,b,c,d){return{restrict:"A",link:function(e,f,g){f.bind("click",function(){function f(b){a.debug("onSuccess",b),c(function(){e[l+i]=!1;var a=k.getParentList(),b=a.indexOf(k);b>-1&&a.splice(b,1)},d.Timeout)}function h(f){a.debug("onError",f),c(function(){e[l+i]=!1,e[l+j]=!0,b[l+"Errors"]||(b[l+"Errors"]=[]),b[l+"Errors"].push(f)},d.Timeout)}var i="Removing",j="Error",k=e.$eval(g.avRestRemove),l=k.route.split("/").reverse()[0];a.debug("avRestRemove directive",k),(!g.restIf||e.$eval(g.restIf))&&(e[l+i]=!0,e[l+j]=!1,k.remove().then(f,h))})}}}]).directive("avRestSave",["$log","$rootScope","Restangular","$timeout","REST_CONFIG",function(a,b,c,d,e){return{restrict:"A",link:function(c,f,g){f.bind("click",function(){function f(b){a.debug("onSuccess",b),d(function(){c[n+i]=!1,l[m]=k},e.Timeout)}function h(f){a.debug("onError",f),d(function(){c[n+i]=!1,c[n+j]=!0,m>-1&&(k.fromServer?l.splice(m,1,c.copy):l.splice(m,1)),b[n+"Errors"]||(b[n+"Errors"]=[]),b[n+"Errors"].push(f)},e.Timeout)}var i="Saving",j="Error",k=c.$eval(g.avRestSave),l=k.getParentList(),m=l.indexOf(k),n=l.route.split("/").reverse()[0];a.debug("avRestSave directive",k),(!g.restIf||c.$eval(g.restIf))&&(c[n+i]=!0,c[n+j]=!1,delete k.editing,k.fromServer?k.put().then(f,h):l.post(k).then(f,h))})}}}]).directive("avRestAdd",["$log",function(a){return{restrict:"A",link:function(b,c,d){c.bind("click",function(){var c=b.$eval(d.avRestAdd);a.debug("avRestAdd directive",c),c.unshift({editing:!0,getParentList:function(){return c}}),b.$applyAsync()})}}}]).directive("avRestClone",["$log",function(a){return{restrict:"A",link:function(b,c,d){c.bind("click",function(){var c=b.$eval(d.avRestClone),e=c.getParentList();a.debug("avRestClone directive",c);var f=c.clone();f.editing=!0,e.unshift(f),b.$applyAsync()})}}}]).directive("avRestEdit",["$log",function(a){return{restrict:"A",link:function(b,c,d){c.bind("click",function(){var c=b.$eval(d.avRestEdit);a.debug("avRestEdit directive",c),b.copy=c.clone(),c.editing=!0,b.$applyAsync()})}}}]).directive("avRestCancel",["$log",function(a){return{restrict:"A",link:function(b,c,d){c.bind("click",function(){a.debug("avRestCancel directive",b);var c,e=b.$eval(d.avRestCancel);c=e.getParentList?e.getParentList():b[d.restName||d.avRestCancel+"s"];var f=c.indexOf(e);f>-1&&(b.copy?c.splice(f,1,b.copy):c.splice(f,1)),b.$applyAsync()})}}}])}(),function(){"use strict";function a(a,b,c,d,e){var f={};return f.wrapRequestsWith=function(a){d=a.wrapRequest(d)},f.setCache=function(a){d.setResponseInterceptor(function(b,c){return a&&e.NoCacheHttpMethods[c]===!0&&a.removeAll(),b})},f.readBatch=function(a){var e=b.defer();return c.get(d.configuration.baseUrl+"/"+a+d.configuration.suffix).success(function(a){e.resolve(a)}),e.promise},f.readParallelMultipleBatch=function(a){var c=[];return angular.forEach(a,function(a){var d=b.defer();f.readBatch(a).then(function(a){d.resolve(a)},function(){d.reject()}),c.push(d.promise)}),b.all(c)},f}a.$inject=["$log","$q","$http","Restangular","REST_CONFIG"],angular.module("appverse.rest").factory("RESTFactory",a)}();
//# sourceMappingURL=appverse-rest.min.js.map