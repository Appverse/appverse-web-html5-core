/*! appverse-web-html5-core - v0.8.0 - */
!function(){"use strict";angular.module("appverse.serverPush",["appverse.configuration"]).run(["$log",function(a){a.info("appverse.serverPush run")}])}(),function(){"use strict";angular.module("appverse.serverPush").factory("WebSocketFactory",["$log",function(a){var b=angular.injector(["appverse.configuration.default"]).get("WEBSOCKETS_CONFIG"),c={};return c.open=function(d,e,f,g,h){if(c.ws)return a.warn("WebSocket connection is already opened. Closing it before opening a new one."),void c.close().then(function(){c.open(d,e,g,h)});var i=null;d||(d=b.WS_URL),"auto"===b.WS_TYPE?"SockJS"in window&&(i=new SockJS(d)):"sockjs"===b.WS_TYPE&&(i=new SockJS(d)),null===i?(a.debug("WS_TYPE: native"),"WebSocket"in window?i=new WebSocket(d):"MozWebSocket"in window&&(i=new MozWebSocket(d))):a.debug("WS_TYPE: sockjs"),i.onopen=function(){null!==i&&i.send(""),f&&f()},i.onerror=function(a){g&&g(a)},i.onmessage=function(a){e&&e(a)},i.onclose=function(){h&&h()},c.ws=i},c.close=function(){c.ws&&(c.ws.close(),c.ws=null)},c.sendRaw=function(b){a.debug("factory.ws: "+c.ws),c.ws.send(b)},c.status=function(){return null===c.ws||angular.isUndefined(c.ws)?WebSocket.CLOSED:c.ws.readyState},c.statusAsText=function(){var a=c.status();return a===WebSocket.CONNECTING?b.CONNECTING:a===WebSocket.OPEN?b.OPEN:a===WebSocket.CLOSING?b.WS_CLOSING:a===WebSocket.CLOSED?b.WS_CLOSED:b.WS_UNKNOWN},c.connect=function(d,e,f,g,h){if(c.client)return void a.warn("Client already exists. Please disconnect it before reconnecting.");if("none"===b.WS_PROTOCOL_TYPE)throw a.warn("No protocol configured WS_PROTOCOL_TYPE=none"),new TypeError("No protocol configured WS_PROTOCOL_TYPE=none");if(!c.ws)return a.debug("No underlying WebSocket connection found. Opening default one..."),void c.open(null,null,function(){c.connect(d,e,f,g)});var i=null;("auto"===b.WS_PROTOCOL_TYPE||"stomp"===b.WS_PROTOCOL_TYPE)&&("Stomp"in window?(i=Stomp.over(c.ws),a.debug("WS_TYPE: sockjs"),null!==b.HEARTBEAT_OUTGOING&&(i.heartbeat.outgoing=b.HEARTBEAT_OUTGOING),null!==b.HEARTBEAT_INCOMING&&(i.heartbeat.incoming=b.HEARTBEAT_INCOMING),i.debug=h,i.connect(d,e,f,g)):a.debug("WS_TYPE: none")),c.client=i},c.subscribe=function(b,d,e){if(c.client||(a.debug("Client does not exists. Connecting to default one..."),c.connect()),"function"!=typeof d)throw new TypeError(d+" is not a function.");return c.client.subscribe(b,d,e)},c.send=function(b,d,e){return null===c.client||angular.isUndefined(c.client)?void a.warn("Client does not exists. Please connect first."):void c.client.send(b,d,e)},c.unsubscribe=function(b){return!b||angular.isUndefined(b)?void a.warn("Subscription missing. Please provide the subcription object you got when subscribing."):void b.unsubscribe()},c.disconnect=function(){return!c.client||angular.isUndefined(c.client)?void a.warn("Client does not exists, please connect first."):(c.client.disconnect(),void(c.client=null))},c}])}();
//# sourceMappingURL=appverse-serverpush.min.js.map