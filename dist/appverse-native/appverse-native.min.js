/*! appverse-web-html5-core - v0.8.0 - */
!function(){"use strict";angular.module("appverse.native",["appverse.detection","appverse.cache"]).config(["$httpProvider","DetectionProvider","REST_CONFIG",function(a,b,c){window.$httpCounter=0;var d=function(a){var b={};return b.Endpoint={},b.Endpoint.Path=a.url.split(c.BaseUrl)[1],c.HostList[a.ind]?(b.Endpoint.Host=c.HostList[a.ind].Host,b.Endpoint.Port=c.HostList[a.ind].Port):console.error("Host not found in Host list: ",c.HostList),"MockServer"===c.ServerMode?b.Endpoint.ProxyUrl=c.MockServer.URL+":"+c.MockServer.Port:b.Endpoint.ProxyUrl="",b},e=function(a){var b={};return b.Headers=[],b.Content=a.data,b.ContentType="application/json",b.Session={},b.Method=a.method,b.StopAutoRedirect=!1,b};a.interceptors.push(["$q","$log",function(f,g){return{request:function(h){if(0!==h.url.indexOf(c.BaseUrl)||!b.hasAppverseMobile())return g.debug("request fallthrough",h),h;if(h.cache&&"GET"===h.method&&a.defaults.cache&&a.defaults.cache.get(h.url))return g.debug("request cached",h),h;g.debug("request override",h),window.$httpCounter++,window["$httpPromise"+window.$httpCounter]=f.defer(),window["$httpConfig"+window.$httpCounter]=angular.copy(h);var i="InvokeService",j="$httpCallback",k=window.$httpCounter;h.ind||(h.ind=0);var l=get_params([e(h),d(h)]),m=Appverse.SERVICE_URI+Appverse.IO.serviceName+"/"+i,n=Appverse.APPVERSE_SERVICE_URI+Appverse.IO.serviceName+"/"+i,o=m;Appverse.is.iOS&&(o=n);var p="";if(null!==j?p=p+"callback="+j:p+="callback=NULL",null!==k?p=p+"&callbackid="+k:(p+="&callbackid=callbackid",k="callbackId"),null!==l&&(Appverse.unescapeNextRequestData?p=p+"&json="+unescape(l):(p=p+"&json="+l,Appverse.unescapeNextRequestData=!0)),window.webkit)return void window.webkit.messageHandlers.service.postMessage({uri:o,query:p});if(window.appverseJSBridge)return o=n,void window.appverseJSBridge.postMessage(o,p);if(window.external&&window.external.notify){var q={uri:n,query:p};return void window.external.notify(JSON.stringify(q))}return AppverseEmulator.eventListenersRegistered&&AppverseEmulator.eventListenersRegistered.indexOf(i)>=0&&(AppverseEmulator.queuedListenerMessagesCount++,console.log("Appverse Emulator - queue listener result for methodName: "+AppverseEmulator.normalizeListenerCallingName(i)),function(a){setTimeout(function(){AppverseEmulator.appverseListenerPollingTimerFunc(a)},AppverseEmulator.pollingInterval)}(Appverse.IO.serviceName+"#"+AppverseEmulator.normalizeListenerCallingName(i))),Appverse.executingInEmulator&&null!==j&&(AppverseEmulator.queuedCallbackMessagesCount++,console.log("Appverse Emulator - queue callback result for methodName: "+i),function(a,b){setTimeout(function(){AppverseEmulator.appverseCallbackPollingTimerFunc(a,b)},AppverseEmulator.pollingInterval)}(j,k)),delete h.headers.Accept,h.headers["Content-Type"]="application/json;charset=UTF-8",h.method="POST",h.url=o,h.data=p,h},response:function(a){if(!a.config.url||0!==a.config.url.indexOf(Appverse.SERVICE_URI+Appverse.IO.serviceName+"/InvokeService"))return a;g.debug("response override",a);var b=a.config.data.split("callbackid=")[1].split("&")[0];return window["$httpPromise"+b].promise}}}])}]).run(["$http","$log",function(a,b){function c(){return Object.create(null)}function d(a){var b,d,e,g=c();return a?(angular.forEach(a.split("\n"),function(a){e=a.indexOf(":"),b=angular.lowercase(f(a.substr(0,e))),d=f(a.substr(e+1)),b&&(g[b]=g[b]?g[b]+", "+d:d)}),g):g}function e(a){var b=angular.isObject(a)?a:void 0;return function(c){if(b||(b=d(a)),c){var e=b[angular.lowercase(c)];return void 0===e&&(e=null),e}return b}}var f=function(a){return angular.isString(a)?a.trim():a};window.$httpCallback=function(c,d){b.debug("$httpCallback id",d),b.debug("$httpCallback result",c);var f={};if(f.config=window["$httpConfig"+d],null!==c){var g="";angular.forEach(c.Headers,function(a){g+=a.Name+":"+a.Value+"\n"}),f.headers=e(g),c.Content.length>0&&(f.data=JSON.parse(c.Content)),f.status=200,f.statusText="OK",f.config.cache&&a.defaults.cache&&"GET"===f.config.method&&a.defaults.cache.put(f.config.url,[f.status,f.data,f.headers(),f.statusText]),window["$httpPromise"+d].resolve(f)}else f.status=404,f.statusText="Error",window["$httpPromise"+d].reject(f);delete window["$httpConfig"+d],delete window["$httpPromise"+d]}}])}(),function(){"use strict";angular.module("appverse.native").run(["$log","$q","Detection","$window","$timeout","$interval",function(a,b,c,d,e,f){if(c.hasAppverseMobile()){var g;d.callbackGeo=function(a){a?Appverse.Geo.StartUpdatingLocation("callbackGeoStart"):g.reject()},d.callbackGeoStart=function(a){a?Appverse.Geo.GetCoordinates("callbackGeoCoordinates"):g.reject()},d.callbackGeoCoordinates=function(a){a?g.resolve(a):g.reject()},d.onAccessToLocationDenied=function(){var a={code:1,message:"Permission denied."};g.reject(a)};var h=function(a,c,d){g=b.defer(),g.promise.then(function(b){var c={};c.coords={latitude:b.XCoordinate,longitude:b.YCoordinate,altitude:b.ZCoordinate,accuracy:(b.XDoP+b.YDoP)/2,altitudeAccuracy:null,heading:null,speed:null},c.timestamp=(new Date).getTime(),a(c),Appverse.Geo.StopUpdatingLocation()})["catch"](function(a){a||(a={code:2,message:"Postion unavailable."}),c(a)}),Appverse.Geo.IsGPSEnabled("callbackGeo"),d&&d.timeout?e(function(){var a={code:3,message:"Request timed out."};g.reject(a)},d.timeout):d={enableHighAccuracy:!1,timeout:window.Infinity,maximumAge:0}};d.navigator&&d.navigator.geolocation&&(d.navigator.geolocation.getCurrentPosition=function(a,b,c){h(a,b,c)},d.navigator.geolocation.watchPosition=function(a,b,c){var d=f(function(){h(a,b,c)},1e3);return d},d.navigator.geolocation.clearWatch=function(a){f.cancel(a),Appverse.Geo.StopUpdatingLocation()});var i,j=function(){i=b.defer(),i.promise.then(function(){c.isOnline=!0})["catch"](function(){c.isOnline=!1}),d.callbackNetwork=function(a){a?i.resolve():i.reject()},Appverse.Net.IsNetworkReachable("www.google.com","callbackNetwork")};j(),d.onConnectivityChange=function(){j()}}}])}();
//# sourceMappingURL=appverse-native.min.js.map